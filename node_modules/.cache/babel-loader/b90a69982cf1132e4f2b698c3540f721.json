{"ast":null,"code":"import _classCallCheck from\"/Users/kshitiz/final-project-tornado-main/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";// 3rd party\nimport{List,fromJS}from'immutable';// project deps\nexport var DispatchAction=function DispatchAction(type,args){_classCallCheck(this,DispatchAction);this.type=void 0;this.args=void 0;this.type=type;this.args=fromJS(args);};/** ------------------------------------------------------------------------ **\n * Top-level application reducer.\n ** ------------------------------------------------------------------------ */export function appReducer(state,action){var type=action.type,args=action.args;console.debug(\"\".concat(type));// Question: Does this function remind of you registering callbacks?\nvar newState=function(){switch(type){case'SET_SOCKET':{var oldSocket=state.get('socket');if(oldSocket){oldSocket.close();}return state.set('socket',args.get('socket'));}case'DELETE_SOCKET':{return state.delete('socket');}case'SET_SONGS':{var songs=args.get('songs');return state.set('songs',songs);}case'PLAY_SONG':{var notes=state.get('songs').find(function(s){return s.get('id')===args.get('id');}).get('notes');return state.set('notes',notes);}case'STOP_SONG':{return state.delete('notes');}case'SET_LOCATION':{var _URLSearchParams$get;var pathname=args.getIn(['location','pathname'],'');var search=args.getIn(['location','search'],'');var instrumentName=pathname.substring(1);var visualizerName=(_URLSearchParams$get=new URLSearchParams(search.substring(1)).get('visualizer'))!==null&&_URLSearchParams$get!==void 0?_URLSearchParams$get:'';var instruments=state.get('instruments');var visualizers=state.get('visualizers');var instrument=instruments.find(function(i){return i.name===instrumentName;});var visualizer=visualizers.find(function(v){return v.name===visualizerName;});return state.set('instrument',instrument).set('visualizer',visualizer);}case'SHOW_SONG_DETAILS':{var SongDetail=args.get('SongDetail');return state.set('SongDetail',SongDetail);}case'SET_ALBUMS':{var Albums=args.get('albums',List());return state.set('Albums',Albums);}case'SET_ALBUM_SONGS':{var _Albums=args.get('Albums',List());var index=args.get('index',Number);return state.set('FilteredSongs',_Albums.get(index).get('songs'));}case'SET_GENRES':{var Genres=args.get('genres',List());return state.set('Genres',Genres);}case'SET_GENRE_SONGS':{var _Genres=args.get('Genres',List());var _index=args.get('index',Number);return state.set('FilteredSongs',_Genres.get(_index).get('songs'));}case'SEARCH_SONGS':{var SearchText=args.get('search',String());var _songs=args.get('songs',List());var FilteredSongs=[];_songs.forEach(function(song){var songTitle=song.get('songTitle').toLowerCase().trim();if(songTitle.includes(SearchText.toLowerCase().trim())){FilteredSongs.push(song);}});return state.set('FilteredSongs',FilteredSongs);}default:console.error(\"type unknown: \".concat(type,\"\\n\"),args.toJS());return state;}}();console.debug(newState.update('socket',function(s){return s?'[socket]':s;}).toJS());return newState;}","map":{"version":3,"sources":["/Users/kshitiz/final-project-tornado-main/client/src/Reducer.tsx"],"names":["List","fromJS","DispatchAction","type","args","appReducer","state","action","console","debug","newState","oldSocket","get","close","set","delete","songs","notes","find","s","pathname","getIn","search","instrumentName","substring","visualizerName","URLSearchParams","instruments","visualizers","instrument","i","name","visualizer","v","SongDetail","Albums","index","Number","Genres","SearchText","String","FilteredSongs","forEach","song","songTitle","toLowerCase","trim","includes","push","error","toJS","update"],"mappings":"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","sourcesContent":["// 3rd party\nimport { List, Map, fromJS } from 'immutable';\n\n// project deps\nimport { Instrument } from './Instruments';\nimport { Visualizer } from './Visualizers';\nimport { AppState } from './State';\n\n/** ------------------------------------------------------------------------ **\n * All user input is handled by DispatchAction.\n ** ------------------------------------------------------------------------ */\n\n/**\n * Observation: pure map (compare and contrast with impure map)\n *\n * 'instrument': Instrument\n * 'visualizer': Visualizer\n * 'songs': List<string>\n * 'notes': List<{id: number, songTitle: string, notes: string}>\n */\ntype DispatchArgs = {\n  [key: string]: any;\n};\n\n// A simple algebraic data-type with string literal types\ntype DispatchActionType =\n  | 'SET_SOCKET'\n  | 'DELETE_SOCKET'\n  | 'SET_SONGS'\n  | 'PLAY_SONG'\n  | 'STOP_SONG'\n  | 'SET_LOCATION'\n  | 'SHOW_SONG_DETAILS' \n  | 'SET_ALBUMS'\n  | 'SET_ALBUM_SONGS'\n  | 'SET_GENRES'\n  | 'SET_GENRE_SONGS'\n  | 'SEARCH_SONGS';\n\nexport class DispatchAction {\n  readonly type: DispatchActionType;\n  readonly args: Map<string, any>;\n\n  constructor(type: DispatchActionType, args?: DispatchArgs) {\n    this.type = type;\n    this.args = fromJS(args) as Map<string, any>;\n  }\n}\n\n/** ------------------------------------------------------------------------ **\n * Top-level application reducer.\n ** ------------------------------------------------------------------------ */\n\nexport function appReducer(state: AppState, action: DispatchAction): AppState {\n  const { type, args } = action;\n\n  console.debug(`${type}`);\n\n  // Question: Does this function remind of you registering callbacks?\n  const newState = (() => {\n    switch (type) {\n      case 'SET_SOCKET': {\n        const oldSocket = state.get('socket');\n        if (oldSocket) {\n          oldSocket.close();\n        }\n\n        return state.set('socket', args.get('socket'));\n      }\n      case 'DELETE_SOCKET': {\n        return state.delete('socket');\n      }\n      case 'SET_SONGS': {\n        const songs = args.get('songs');\n        return state.set('songs', songs);\n      }\n      case 'PLAY_SONG': {\n        const notes = state\n          .get('songs')\n          .find((s: any) => s.get('id') === args.get('id'))\n          .get('notes');\n        return state.set('notes', notes);\n      }\n      case 'STOP_SONG': {\n        return state.delete('notes');\n      }\n      case 'SET_LOCATION': {\n        const pathname = args.getIn(['location', 'pathname'], '') as string;\n        const search = args.getIn(['location', 'search'], '') as string;\n\n        const instrumentName: string = pathname.substring(1);\n        const visualizerName: string =\n          new URLSearchParams(search.substring(1)).get('visualizer') ?? '';\n        const instruments: List<Instrument> = state.get('instruments');\n        const visualizers: List<Visualizer> = state.get('visualizers');\n\n        const instrument = instruments.find(i => i.name === instrumentName);\n        const visualizer = visualizers.find(v => v.name === visualizerName);\n\n        return state\n          .set('instrument', instrument)\n          .set('visualizer', visualizer);\n      }\n\n      case 'SHOW_SONG_DETAILS':{\n        const SongDetail = args.get('SongDetail');\n        return state.set('SongDetail',SongDetail);\n      }\n\n      case 'SET_ALBUMS':{\n        let Albums : List<any> = args.get('albums',List());\n        return state.set('Albums',Albums);\n      }\n\n      case 'SET_ALBUM_SONGS':{\n        let Albums : List<any> =args.get('Albums',List())\n        let index : number = args.get('index',Number);\n        return state.set('FilteredSongs',Albums.get(index).get('songs'));\n      }\n\n      case 'SET_GENRES':{\n        let Genres : List<any> = args.get('genres',List());\n        return state.set('Genres',Genres);\n      }\n\n      case 'SET_GENRE_SONGS':{\n        let Genres : List<any> = args.get('Genres',List());\n        let index: number = args.get('index',Number);\n        return state.set('FilteredSongs',Genres.get(index).get('songs'));\n      }\n\n      case 'SEARCH_SONGS':{\n        let SearchText : String = args.get('search',String());\n        let songs : List<any> = args.get('songs',List());\n        let FilteredSongs : any[] = [];\n        songs.forEach(song=>{\n          let songTitle : String = song.get('songTitle').toLowerCase().trim();\n          if(songTitle.includes(SearchText.toLowerCase().trim()))\n          {\n            FilteredSongs.push(song);\n          }\n        })\n        return state.set('FilteredSongs',FilteredSongs);\n      }\n\n      default:\n        console.error(`type unknown: ${type}\\n`, args.toJS());\n        return state;\n    }\n  })();\n\n  console.debug(newState.update('socket', s => (s ? '[socket]' : s)).toJS());\n\n  return newState;\n}\n"]},"metadata":{},"sourceType":"module"}